<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="" xml:lang="en" lang="en" dir="ltr">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>{PageTitle}Bucardo</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "/css/common/shared.css";
			@import "/css/BucardoGreen/main-glossy.css";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="?303" />
		<!--[if lt IE 7]><meta http-equiv="imagetoolbar" content="no" /><![endif]-->
	</head>
<body class="mediawiki  ltr ">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="bodyContent">
			<div id="contentSub"></div>
			<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<p>The complete list of changes for Bucardo can also be found in the <strong>Changes</strong> file that ships with Bucardo.</p>

<p>[GSM is Greg Sabino Mullane <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#103;&#114;&#101;&#103;&#064;&#101;&#110;&#100;&#112;&#111;&#105;&#110;&#116;&#046;&#099;&#111;&#109;">&#103;&#114;&#101;&#103;&#064;&#101;&#110;&#100;&#112;&#111;&#105;&#110;&#116;&#046;&#099;&#111;&#109;</a> <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#103;&#114;&#101;&#103;&#064;&#116;&#117;&#114;&#110;&#115;&#116;&#101;&#112;&#046;&#099;&#111;&#109;">&#103;&#114;&#101;&#103;&#064;&#116;&#117;&#114;&#110;&#115;&#116;&#101;&#112;&#046;&#099;&#111;&#109;</a> ]</p>

<h1 id="bucardo-version-540-released-august-6-2015">Bucardo version 5.4.0, released August 6, 2015</h1>

<ul>
  <li>(git commit a0eff9f6558cc2c6b19e4e675604250ad00ce420)</li>
  <li>Allow dashes in valid schema and table names [David Christensen]</li>
  <li>New command “bucardo delta [syncname…]” to show number of pending delta rows on source databases. [Greg Sabino Mullane]</li>
  <li>Fix incorrect usage of the ‘dbconn’ parameter in the bucardo.db table [Greg Sabino Mullane, reported by Alexandre Busquets]</li>
  <li>Fix case where VAC sometimes skipped databases used in multiple syncs. [Greg Sabino Mullane, reported by Andrey Solovjov]</li>
  <li>Adjustments for new version of ExtUtils::MakeMaker [Mathieu Arnold]</li>
  <li>When doing target deletes, use the quoted version of the primary key column names.[Greg Sabino Mullane]</li>
  <li>Make sure we do not signal other syncs during makedelta runs if the other syncs are inactive or have autokick off. [Greg Sabino Mullane]</li>
  <li>Allow code with ‘array_agg’ to work on Postgres &lt;= 8.2, along with many other minor changes to support older versions. [Greg Sabino Mullane]</li>
  <li>Add new internal function bucardo_purge_delta_oid which helps the VAC process work better on older versions of Postgres (&lt;= 8.2) [Greg Sabino Mullane]</li>
  <li>Add new function bucardo_purge_sync_track which removes all track and delta entries for a given sync. Use with care. [Greg Sabino Mullane]</li>
  <li>Allow ‘bucardo validate’ to drop the autokick triggers if they are no longer needed. [Greg Sabino Mullane]</li>
  <li>Add ‘PRAGMA defer_foreign_keys’ for sqlite targets [Greg Sabino Mullane]</li>
  <li>Do not try to apply ‘READ WRITE’ when doing the initial SET TRANSACTION for MySQL and MariaDB, as that option is not supported across all versions.[Greg Sabino Mullane]</li>
  <li>Remove default value from sync.isolation_level, so we can default to the global one when needed.[Greg Sabino Mullane]</li>
  <li>Improve workings of the ‘pkonly’ argument to “bucardo add tables” [Greg Sabino Mullane]</li>
  <li>Make ‘bucardo list relgroup foo’ show the tables in priority order. [Greg Sabino Mullane]</li>
  <li>Make ‘bucardo list all’ a little less verbose for some not-so-common items [Greg Sabino Mullane]</li>
  <li>Fix up the “add relgroup” call to allow it to work for capitalized relations, and remove a prepare_cached error that could occur.[Greg Sabino Mullane]</li>
  <li>Allow validate_sync to check the contents of functions for upgrade, not just their existence.[Greg Sabino Mullane]</li>
  <li>Do not ‘RESET search_path’ inside some of the internal functions. [Greg Sabino Mullane]</li>
  <li>Sleep longer between stop and start when doing ‘bucardo restart’ [Greg Sabino Mullane]</li>
</ul>

<h1 id="bucardo-version-531-released-january-27-2015">Bucardo version 5.3.1, released January 27, 2015</h1>

<ul>
  <li>(git commit a4e59ea351410acd4fe750384a19393c261f7e91)</li>
</ul>

<!-- -->

<ul>
  <li>When clearing out the async mode, do not do so unless the state() is sane. This will solve some of the “pg_cancel failed” errors seen [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Throw a cleaner and earlier exception when connect_database fails [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Give a warning when a bucardo rc file has an unparseable line [Greg Sabino Mullane]</li>
</ul>

<h1 id="bucardo-version-530-released-december-22-2014">Bucardo version 5.3.0, released December 22, 2014</h1>

<ul>
  <li>(git commit 07d884fea5ba113b5d314c318bcff2cced55b6bb)</li>
</ul>

<!-- -->

<ul>
  <li>Fix race condition when makedelta used which could cause some rows to be incorrectly entered into the track table [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Fix bug when makedelta used on tables with binary primary key columns [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Allow ‘makedelta’ to be specified at the database level [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Give customcodes access to the list of changed rows via the ‘rows’ key in the passed-in hashref [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Allow specification of non-default port when sending email. Attempt support for SASL auth. [Greg Sabino Mullane, per suggestion from Michael Wagner]</li>
</ul>

<!-- -->

<ul>
  <li>Better support for continuing once a database has crashed [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Allow removing all tables or sequences at once via command line, e.g. ‘bucardo remove all tables’ [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Allow –makedelta=foo to work on command line when adding all tables [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>New test file t/50-star.t and much improvement to testing framework [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Added new logging level, DEBUG2, for things that are just too verbose even for DEBUG! [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>When the VAC exits, disconnect from any databases cleanly we may still be connected to. [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Allow –dryrun to work when adding items, esp. tables [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Allow msg as alias for message e.g. ‘bucardo msg foobar’ [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>When showing microseconds in the log, force the third and final zero to appear [Greg Sabino Mullane]</li>
</ul>

<h1 id="bucardo-version-520-released-november-5-2014">Bucardo version 5.2.0, released November 5, 2014</h1>

<ul>
  <li>(git commit 003b827a73a6e2e51cc5e833a5b4bc21631bd216)</li>
</ul>

<!-- -->

<ul>
  <li>quickstart: new parameter to give on startup (e.g. “bucardo start –quickstart”).When set, skips checking the tables and columns on remote databases. [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Fix problem of not clearing out stagetable before using it. There was a chance that a previous KID left some rows in there, in which case duplicate entries will appear in bucardo_track. [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Make sure makedelta only adds matching track table rows if the current database is a source, not a target, for the current sync. [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Fix some errant global variables which were causing subtle bugs in the makedelta system. [Greg Sabino Mullane]</li>
</ul>

<h1 id="bucardo-version-512-released-october-15-2014">Bucardo version 5.1.2, released October 15, 2014</h1>

<ul>
  <li>(git commit 6b8f02feaef5b116dfba9b57f6a0617d73ba3657)</li>
</ul>

<!-- -->

<ul>
  <li>Fix problem with async failures [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Fix add_customcols params parsing [David Christensen]</li>
</ul>

<!-- -->

<ul>
  <li>Improve MCP loop handling on errors [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Make sure makedelta can be set for all databases, not just source ones [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Fix minor bug in send_mail subroutine [Greg Sabino Mullane]</li>
</ul>

<!-- -->

<ul>
  <li>Remove Encode::Locale dependency [Joshua Tolley]</li>
</ul>

<!-- -->

<ul>
  <li>Allow ‘git list config*’ to work as an alias for git config. Make plain ‘git config’ act as ‘git show all’ [Greg Sabino Mullane]</li>
</ul>

<h1 id="bucardo-version-511-released-july-23-2014">Bucardo version 5.1.1, released July 23, 2014</h1>

<ul>
  <li>(git commit c91753ef834cdcac311d66851947d1e4cb8acc7c)</li>
  <li>Minor fixes to conflict handling. [GSM]</li>
  <li>Fix upgrade to add updating of defaults. [GSM]</li>
</ul>

<h1 id="bucardo-version-510-released-july-14-2014">Bucardo version 5.1.0, released July 14, 2014</h1>

<ul>
  <li>(git commit 7465d87ec60d29555fc2a38e70e08cc09e33a7db)</li>
  <li>Many fixes and features added to the conflict resolution system. [GSM]</li>
  <li>Fix the upgrade so new constraints are handled better. [GSM]</li>
</ul>

<h1 id="bucardo-version-500-released-june-23-2014">Bucardo version 5.0.0, released June 23, 2014</h1>

<div class="highlighter-rouge">  (git commit 2349582733df31a4115b952bfcc2f5732d5af16a)

  - Complete rework of Bucardo: we now allow as many source and target
    databases as wanted in a single sync. [GSM]

  - Allow alternate targets: Drizzle, MariaDB, MongoDB, MySQL, Oracle, Redis,
    SQLite, as well as "flat files" [GSM]

  - Rename "bucardo_ctl" to simply "bucardo" [Jon Jensen, GSM]

  - Rename "goat" to "relation" or, more commonly, "table" and "sequence".
    [David Wheeler]

  - Rename "standard_conflict" option to "conflict_strategy".

  - Rename "herd" to "relgroup". [David Wheeler]

  - Change the way that swap syncs work: should be much faster [GSM]

  - Use asynchronous queries when possible [GSM]

  - Redo the makedelta system, and add makedelta option for relations, which
    inherit from db. Add makedelta as on/off for db. [GSM]

  - Overhaul of sequence handling: now allows for all attributes to be replicated,
    such as INCREMENT_BY and MAXVALUE [GSM]

  - Fix for failing swap syncs when column is not all lowercase. [GSM]

  - Fix for proper sourcelimit and targetlimit calculations. [GSM]

  - Add slony_migrator.pl script [Josh Tolley]

  - Add example scripts in 'bucardo_examples' directory [Selena Deckelmann]

  - Allow 'list sync' to filter by 'active' and 'inactive' [GSM]

  - Remove unused config variable 'upsert_attempts' [GSM]

  - Show detailed information on KID error exit. [GSM]

  - Fix bug in bucardo_purge_q_table in index detection logic. [Aolmezov]

  - Show the reason why a sync failed on a failed bucardo kick. [GSM]

  - Add new subprocess (VAC) to run bucardo_purge_delta. [GSM]

  - Fix errors with bytea and swap syncs. [GSM]

  - Do not replicate null values to MongoDB [Ali Asad Lotia]

  - Add 'default_conflict_strategy' option, per idea from Franz Dürr. [GSM]

  - Force time zone to UTC to resolve timestamptz issues with bucardo_delta
    [GSM, Michelle Sullivan]

  - Add a log_level parameter, and classify all messages inside Bucardo.pm
    with a log_level of TERSE, NORMAL, VERBOSE, or DEBUG. [Rosser Schwarz and GSM]

  - Relax SELECT version() regex in bucardo, to let modified versions
    of Postgres tell us their version. [GSM]

  - Fix incorrect automatic population of database when using
    'bucardo add database' and only one database exists. [GSM]

  - Fix failing makedelta when using multi-column primary keys.
    [GSM, reported by Michelle Sullivan]

  - Add new vacuum_after_copy variable for goats and syncs. [GSM]

  - Do not perform a checktime kick if onetimecopy mode is on. [GSM]

  - New syncs of type fullcopy now default to false for ping, stayalive,
    and kidsalive. [GSM, idea from Andrew Spencer]

  - Refuse to start if the bucardo database version does not match that of
    bucardo (the former is set by 'bucardo upgrade') [GSM]

  - Set the search_path to prevent bogus warnings on startup about sequence
    mismatches based on schema names. [GSM] (Bug #17)

  - Add a --force option so we can remove databases via 'bucardo remove db'
    along with all related goats and syncs. [GSM]

  - Change bucardo.dbrun table column pgpid to INTEGER [Wim Lewis]

  - Remove race condition from bucardo_purge_q_table() [GSM]

  - Add new options for 'bucardo add db': addalltables and addallsequences [GSM]

  - Allows syncs to be paused and resumed while they are running. [GSM]

  - Allow 'bucardo status' to run even if piddir is not available. [GSM]

  - Don't bother comparing the 'log_cnt' field of sequences. [Rosser Schwarz]

  - Allow "schema.table" format for 'bucardo list tables' [GSM]

  - Add new option "log_microsecond" to show sub-second output in logs. [GSM]

  - Make sure we update bucardo_config.bucardo_current_version when doing
    a 'bucardo upgrade' [GSM] (Bug #5)

  - Automatically create the bucardo (superuser) if we can connect as 'postgres'. [GSM]

  - Add 'bucardo list all' feature [Christian Recktenwald]

  - Allow removal of tables from relgroups via bucardo. [GSM]

  - Add create_child_q_table() function. [GSM]

  - Allow 'bucardo update relgroup foo remove &lt;table(s)&gt;'
    and 'bucardo update relgroup foo add &lt;table(s)&gt;' [GSM]

  - Rename the default reason_file to bucardo.restart.reason.txt. The reason
    log is then named bucardo.restart.reason.log (instead of
    bucardo.restart.reason.log.log as before). [David Wheeler]

  - Better formatting of bucardo.reason.txt.log, and log startup failures. [GSM]

  - Log the current configuration settings on startup. [GSM]

  - Fix incorrect assignment of ppid in the bucardo.q table. [GSM]

  - Remove unused 'kick_sleep' config variable. [GSM]

  - Show the database name when listing relgroups via bucardo. [GSM]

  - Show the database name when listing sequences via bucardo. [Douglas Tan]

  - Show each target's Postgres version, time, and timezone on first connect. [GSM]

  - Change main trigger names to 'bucardo_delta' and 'bucardo_kick' [GSM]

  - Allow databases to have the same dsn, as we are moving towards in-database
    replication. [GSM]

  - Add complete documentation of all public commands, actions, parameters,
    and options to the bucardo Pod (and therefore the man page, as well).
    [David Wheeler]

  - Use the Pod docs to show the output of 'help command' and 'help command action'
    instead of duplicating that information in code. [David Wheeler]

  - Fixed PostgreSQL 9.2 compatibility issues. [David Wheeler]

  - Fix syntax issues to restore support for PostgreSQL 8.1 [GSM]

  - Fix "arguments of row IN must all be row expressions" error [GSM]

  - Fix empty primary key join/split bug [GSM]

  - Add Linux int script and RPM spec file [Devrim GÜNDÜZ and David Wheeler]

  - Add --exit-on-nosync option. Bucardo no longer exits from 'start' when
    there are no syncs. Use this option to restore that behavior. [David
    Wheeler]

  - Switch to pg_ctl in tests for more reliable (and faster!) Postgres
    startup and shutdown. [David Wheeler]

  - Fix incorrect shutdown when Postgres is not running. The pid file is now
    properly cleaned up on shutdown even if Postgres is down. [David Wheeler]

  - Tests now properly report the reasons for failed bucardo commands. [David
    Wheeler]

  - Revamp retry on serialization failure so that it actually works. The KID
    no longer sleeps and exits, but sleeps and retries the sync on its own,
    only sending a NOTICE to other processes that it is doing so. [GSM and
    David Wheeler]

  - Change the default serialization failure sleep time from 10s to 0.5s.

  - Added new 'bucardo reopen' command to reopen all open file handles
    Useful for log rotation.
    [Greg Sabino Mullane].

  - The 'update' command no longer exits with an error code on success.

  - Fixed issue with missing database handles when a KID shuts down. [David
    Wheeler]

  - Remove the customselect parameter. Use the customcols command, instead.
    [David Wheeler]

  - Remove the do_listen parameter, which was just another name for ping.

  - Rename the 'ping' parameter to 'autokick', to better describe what it does
    and to prevent confusion with the 'ping' command, which does something
    totally different. [David Wheeler]

  - Rename standard_conflict to conflict_strategy. [David Wheeler]

  - Move conflict_strategy from add/update table to add/update sync. [David Wheeler]

  - Fix issue that prevented the VAC process from shutting down immediately on
    'stop'. [David Wheeler]

  - Fix failure to restart after database disconnections.

  - Add 'remove sequence' [David Wheeler]

  - Rename most --debug* options to --log-*:
      + --debugdir is now --log-destination
      + --debugfile is deprecated; use '--log-destination none' to disable all logging
      + --debugsyslog is deprecated; use --log-destination syslog'
      + Allow logging to stderr or stdout via --log-destination
      + --log-destination may be specified multiple times for multiple logs
      + --debugfilesep is now --log-separate
      + --debugname is now --log-extension
      + --cleandebugs is now --log-clean
    [David Wheeler]

  - Eliminated 'Use of "goto" to jump into a construct has been deprecated'
    warnings on Perl 5.12 and higher.

  - Removed the 'trigrules' attribute for customcodes. Callers should
    (carefully!) change session_replication_role themselves. [GSM]
</div>

<h1 id="bucardo-version-448-released-november-30-2011">Bucardo version 4.4.8, released November 30, 2011</h1>

<ul>
  <li>Fix incorrect checking of hostname for host_safety_check [GSM]</li>
  <li>Fix wrong version number in the bucardo_ctl script.</li>
</ul>

<h1 id="bucardo-version-447-released-november-8-2011">Bucardo version 4.4.7, released November 8, 2011</h1>

<ul>
  <li>Fix bug when using multi-column primary keys where the first is an int, and the second is not. Reported by Brady S Edwards [GSM]</li>
  <li>Do not rely on $@ to catch important evals [GSM]</li>
</ul>

<h1 id="bucardo-version-446-released-july-10-2011">Bucardo version 4.4.6, released July 10, 2011</h1>

<ul>
  <li>Fix bug resulting in wrong escapes in swap syncs for int4 primary keys. Reported by Kiriakos Tsourapas. [GSM]</li>
</ul>

<h1 id="bucardo-version-445-released-june-18-2011">Bucardo version 4.4.5, released June 18, 2011</h1>

<ul>
  <li>Set SECURITY DEFINER on triggerkick functions. [GSM]</li>
</ul>

<h1 id="bucardo-version-444-released-may-14-2011">Bucardo version 4.4.4, released May 14, 2011</h1>

<ul>
  <li>Make sure we escape backslashes when building the DELETE queries for pushdelta syncs [GSM]. Reported by Gabriel Weinberg.</li>
  <li>Report correct number of inserts/deletions in bucardo_ctl status [GSM]. Reported by Gabriel Weinberg.</li>
</ul>

<h1 id="bucardo-version-443-released-april-15-2011">Bucardo version 4.4.3, released April 15, 2011</h1>

<ul>
  <li>Fix rare race condition when slave database dies. [GSM] Thanks to Kaveh Mousavi Zamani for the report.</li>
</ul>

<h1 id="bucardo-version-442-released-march-17-2011">Bucardo version 4.4.2, released March 17, 2011</h1>

<ul>
  <li>Fix incorrect SET TIME ZONE inside the bucardo_delta functions. [GSM]</li>
</ul>

<h1 id="bucardo-version-441-released-november-9-2010">Bucardo version 4.4.1, released November 9, 2010</h1>

<ul>
  <li>Set the search_path to prevent bogus warnings on startup about sequence mismatches based on schema names. [GSM] (Bug #17)</li>
  <li>Fix failing makedelta when using multi-column primary keys. [GSM, reported by Michelle Sullivan]</li>
  <li>Fix for failing swap syncs when column is not all lowercase. [GSM]</li>
  <li>Fix errors with bytea and swap syncs. [GSM]</li>
  <li>Use clock_timestamp if Postgres version is 8.2 or better. (Bug #25) Thanks to David Christensen <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#100;&#097;&#118;&#105;&#100;&#064;&#101;&#110;&#100;&#112;&#111;&#105;&#110;&#116;&#046;&#099;&#111;&#109;">&#100;&#097;&#118;&#105;&#100;&#064;&#101;&#110;&#100;&#112;&#111;&#105;&#110;&#116;&#046;&#099;&#111;&#109;</a> for digging in and solving this.</li>
  <li>Fix error in bind_param for target to source. [GSM]</li>
  <li>Make sure we truly reset onetimecopy for persistent controllers and children. [GSM]</li>
  <li>If in onetimecopy mode, always create a q entry, regardless of synctype. [GSM]</li>
  <li>Rename the ENCODE call for bytea selects. [GSM]</li>
  <li>Always make the source transaction serializable. [GSM]</li>
  <li>Force time zone to GMT to resolve timestamptz issues with bucardo_delta [GSM, Michelle Sullivan]</li>
  <li>Allow ‘2’ as a valid sqlstate after exception thrown. [GSM]</li>
  <li>Fix typo with ‘lowest/highest’ standard conflict methods. Caught by Don Drake.</li>
  <li>Remove race condition from bucardo_purge_q_table() [GSM]</li>
  <li>Make search_path declaration LOCAL in bucardo_audit() [GSM]</li>
  <li>Fix bug in bucardo_purge_q_table in index detection logic. [Aolmezov]</li>
  <li>Don’t bother comparing the ‘log_cnt’ field of sequences. [Rosser Schwarz]</li>
  <li>Do not perform a checktime kick if onetimecopy mode is on. [GSM]</li>
  <li>Add quote() methods to safe list for DBIx::Safe call [GSM]</li>
  <li>Add -vv option to bucardo_ctl as a shortcut for –verbose –verbose [GSM]</li>
  <li>Don’t allow kicking of inactive syncs. [GSM]</li>
  <li>Relax SELECT version() regex in bucardo_ctl, to let modified versions of Postgres tell us their version. [GSM]</li>
  <li>Change DESTDIR to INSTALL_BASE in the makefile [GSM]</li>
  <li>No need to look at anything but ONLY master_q for populate_child_q function. [GSM]</li>
  <li>Automatically create the bucardo (superuser) if we can connect as ‘postgres’. [GSM]</li>
  <li>Allow ‘bucardo_ctl status’ to run even if piddir is not available. [GSM]</li>
  <li>Allow “schema.table” format for bucardo_ctl list tables [GSM]</li>
  <li>Show the database name when listing herds via bucardo_ctl. [GSM]</li>
  <li>Show the database name when listing sequences via bucardo_ctl. [Douglas Tan]</li>
  <li>Make sure we update bucardo_config.bucardo_current_version when doing a bucardo_ctl upgrade [GSM] (Bug #5)</li>
  <li>Add additional clause to the the q_cleanup index. [GSM]</li>
  <li>Remove unused config variable ‘upsert_attempts’ [GSM]</li>
  <li>Remove unused ‘kick_sleep’ config variable. [GSM]</li>
  <li>Show additional version information on startup for debugging [GSM]</li>
</ul>

<h1 id="bucardo-version-440-released-october-14-2009">Bucardo version 4.4.0, released October 14, 2009</h1>

<ul>
  <li>Allow validate_goat() to work correctly against pgbouncer databases by respecting the server_side_prepares parameter. [GSM]</li>
  <li>Loosen restrictions on customcode - now the derived columns must match the target, but the target and source tables can be completely different. [GSM]</li>
  <li>Add the bucardo_audit() function that runs on all master databases, ensures that everything related to the bucardo_* control tables is correct. [Josh Tolley and GSM]</li>
  <li>Fix bucardo_ctl add sync … tables=x - now adds the sync on first pass, even if the tables have not been added. [GSM]</li>
  <li>Adding customcode via bucardo_ctl can now specify sync, goat, priority, and active columns. [GSM]</li>
  <li>When viewing customcode via ‘bucardo_ctl list code foo’, the src_code column is shown last. [GSM]</li>
  <li>Add some small sleeps before checking for stale pid files, to allow their owners a chance to clean them up first. [GSM]</li>
  <li>Give a warning when kicking an inactive sync. [GSM]</li>
  <li>Remove ‘text’ casting which prevented ‘bucardo_ctl inspect’ from working on older versions of Postgres. [GSM]</li>
  <li>Allow testing of multiple versions of Postgres at the same time by setting the environment variables PGBINDIR[A-Z]. [GSM]</li>
</ul>

<h1 id="bucardo-version-430-released-october-8-2009">Bucardo version 4.3.0, released October 8, 2009</h1>

<ul>
  <li>Allow MCP and CTL to kill based on piddir, not just audit_pid. This will prevent duplicate kids from existing if audit_pid is switched off. [GSM]</li>
  <li>Fix error in lowest/highest conflict handling. [Mathieu Arnold]</li>
  <li>Add new column to customcode: trigrules. Defaults to false: if true, we turn on triggers and rules for the duration of the custom code. [GSM]</li>
  <li>Add a new configuration value ‘host_safety_check’, to help prevent Bucardo from being copied from one host to another and then run without modifying at least bucardo.db.dbhost first. [GSM]</li>
  <li>For custom code exception handlers, make the ‘dbi_error’ hash key return a flattened string of the actual exception thrown. [GSM]</li>
  <li>Ensure exiting processes always remove their pidfile. [GSM]</li>
  <li>Have the MCP clean up old pid files from the piddir on startup. [GSM]</li>
  <li>Remove the ‘pidfile’ configuration option: now hard-coded to ‘bucardo.mcp.pid’ [GSM]</li>
  <li>Make the pid file names more consistent, add new ones for kid processes. [GSM]</li>
  <li>Refactor the killing of pids, make safer by checking they are bucardo-like [GSM]</li>
  <li>Remove the PIDCLEANUP option from Bucardo.pm [GSM]</li>
  <li>Better upgrading of very old versions of Bucardo. [GSM]</li>
  <li>Allow add, remove, and list customcode through bucardo_ctl [GSM]</li>
  <li>Allow bucardo_ctl upgrade to remove configuration settings. [GSM]</li>
</ul>

<h1 id="bucardo-version-422-released-october-2-2009">Bucardo version 4.2.2, released October 2, 2009</h1>

<ul>
  <li>Fix so that warning_file works properly again. [GSM]</li>
</ul>

<h1 id="bucardo-version-421-released-october-1-2009">Bucardo version 4.2.1, released October 1, 2009</h1>

<ul>
  <li>Improve ability of ‘bucardo_ctl upgrade’ to work against older versions of Bucardo [GSM]</li>
  <li>Changed the chunking threshold for pushdelta to 100,000 and 10,000 [GSM]</li>
  <li>
    <table>
      <tbody>
        <tr>
          <td>Make bucardo_ctl list table</td>
          <td>sequence follow same wildcard rules as other list nouns. [GSM]</td>
        </tr>
      </tbody>
    </table>
  </li>
  <li>Remove the old ‘alter’ verb from bucardo_ctl: use ‘update’ instead [GSM]</li>
  <li>Fix a SQL error in ‘bucardo_ctl status <sync> \[GSM\]</sync></li>
  <li>Remove the unused t/bucardo.test.data file [GSM]</li>
</ul>

<h1 id="bucardo-version-420-released-september-30-2009">Bucardo version 4.2.0, released September 30, 2009</h1>

<ul>
  <li>Add the “delta_bypass” feature, which allows a pushdelta sync to switch to ‘fullcopy’ mode on the fly, depending on the number of rows that have changed. [GSM]</li>
  <li>Fixed an error preventing customselect from working in certain situations. [GSM]</li>
  <li>Have ‘bucardo_ctl install’ check for successful plperlu installaion [GSM]</li>
  <li>Clean up and standardize all the bucardo_ctl list/add/remove actions. [GSM]</li>
</ul>

<h1 id="bucardo-version-412-released-september-25-2009">Bucardo version 4.1.2, released September 25, 2009</h1>

<ul>
  <li>Fix sequence replication by setting is_called properly on the targets [GSM, thanks to Selena Deckelmann for discovering this]</li>
  <li>Respect server_side_prepares db setting in validate_sync. Previously, this function would fail if validating more than one table at a time and the database was set as server_side_prepares off [GSM]</li>
  <li>Make sure we cast rowid* to text within the bucardo_add_delta-called functions, for picky versions of Postgres. [GSM]</li>
</ul>

<h1 id="bucardo-version-411-released-september-24-2009">Bucardo version 4.1.1, released September 24, 2009</h1>

<ul>
  <li>Fix case where Bucardo was too eager to lock tables post serialization failures. Since we can’t really do this automatically and safely, remove the code in question for now. [GSM, hat tip to Selena Deckelmann]</li>
</ul>

<h1 id="bucardo-version-410-released-september-24-2009">Bucardo version 4.1.0, released September 24, 2009</h1>

<ul>
  <li>Fix problem with possible function name collision when the names of the combined columns in the primary key is greater than NAMEDATALEN, which we’ll assume is 63. [GSM]</li>
  <li>Add “bucardo_ctl inspect table” to show all dependencies, as well as cross referencing against herds the table is in [GSM]</li>
  <li>Fix an error when validate_sync tries to recreate an existing trigger; occurred when a fullcopy sync was set to ping=true [GSM]</li>
  <li>When using “bucardo_ctl add all tables db=<name>", make sure we only look for the already added tables for that specific database. \[Selena Deckelmann and Josh Tolley\]</name></li>
  <li>Add new boolean column to the “db” table named “server_side_prepares”, which is true by default. If off, Bucardo will not use server-side prepared statements, and thus can be used in PgBouncer’s transaction mode. [GSM, idea by Andrew Spencer]</li>
  <li>During pushdelta, break large number of rows for a single table until multiple DELETE and COPY calls, to help debugging, to allow for a progress indicator both at the Bucardo and Postgres levels, and to prevent crashes seen on older versions of Postgres when very large IN() lists are used. [GSM]</li>
  <li>When using “bucardo_ctl add all tables”, ignore any tables inside schemas starting with ‘bucardo’ [GSM]</li>
  <li>Allow –verbose flag for list syncs to show linked tables [GSM]</li>
  <li>Allow –verbose flag for list tables to show linked herds and syncs [GSM]</li>
  <li>Change rebuild_index to a smallint: a 1 only runs it with a fullcopy. If you really want to use it otherwise, set it to 2 [GSM]</li>
  <li>Allow the dbhost to be turned off (local socket only) in the db table when using “bucardo_ctl update db <name> host=non. \[GSM\]</name></li>
</ul>

<h1 id="version-403-released-september-16-2009">Version 4.0.3, released September 16, 2009</h1>

<ul>
  <li>Fix some minor problems with bucardo_ctl and “add sync” [GSM]</li>
  <li>Allow ping to be specified for new tables added via “add sync” [GSM]</li>
</ul>

<h1 id="version-402-released-september-16-2009">Version 4.0.2, released September 16, 2009</h1>

<ul>
  <li>Add the name of the database to the install choices, as some systems have mismatched names (BSD’s ‘pgsql’ user) [Vilem Kebrt]</li>
  <li>Clear out stale q entries on startup, created when a kid was hit with a kill -9. This was causing Bucardo to think the q slot was still active. [GSM]</li>
  <li>Fix cases where we were not quoting the UNLISTEN names [GSM]</li>
  <li>Remove duplicate PID numbers from log [GSM]</li>
  <li>Prohibit syncs from having names reserved for synctypes. [GSM]</li>
  <li>Add new delete method of “truncate_cascade” for syncs [GSM]</li>
  <li>Allow “foo*”, “*foo”, and “*foo*” wildcard format in bucardo_ctl when specifying syncs, e.g. bucardo_ctl kick ABC* [GSM]</li>
  <li>Allow special cases for bucardo_ctl kick: “all [synctype] [active]” [GSM]</li>
  <li>Allow filtering of ‘bucardo_ctl list syncs’ by synctype [GSM]</li>
  <li>Allow ‘bucardo_ctl add sync tables=…’ to work with schema.table format [GSM]</li>
  <li>Add –verbose option to ‘bucardo_ctl list syncs’ to show tables [GSM]</li>
  <li>Allow name changes for syncs, herds, dbs, dbgroups [GSM]</li>
  <li>Automatically add missing tables when doing “bucardo_ctl add sync source=dbname … tables=x,y,z” [GSM]</li>
  <li>Allow multiple items to be changed at one time with ‘bucardo_ctl update item’ [GSM]</li>
  <li>Change validate_sync notice to LOG [GSM]</li>
</ul>

<h1 id="version-401-released-september-8-2009">Version 4.0.1, released September 8, 2009</h1>

<ul>
  <li>Fix to allow “add all tables db=foo” to work as expected.</li>
  <li>Set audit_pid to be off by default.</li>
  <li>Fix broken WHERE clause inside bucardo_ctl for “add table”</li>
</ul>

<h1 id="version-400-released-september-7-2009">Version 4.0.0, released September 7, 2009</h1>

<h2 id="new-features">New features:</h2>

<ul>
  <li>Add support for multi-column primary keys. Thanks to Backcountry.com. [GSM]</li>
  <li>Add new ‘onetimecopy’ attribute to sync table, to allow recreation on demand of pushdelta tables on slaves via COPY. [GSM]</li>
  <li>Support for replication after TRUNCATE. This will only work on Postgres version 8.4 and higher, and only pushdelta syncs. [GSM]</li>
  <li>Add log_conflict_details to allow logging of conflict information to a separate file. [Adam Wendt]</li>
  <li>Add ‘maxkicks’ and ‘lifetime’ to syncs to force restart of controller and kids after a certain number of kicks or time. [Josh Tolley] Thanks to Backcountry.com.</li>
  <li>Add the bucardo_custom_trigger table, which allows tight control of exactly what items in a table will be replicated. [Ben Allen]</li>
  <li>Add the bucardo_rate table to track exactly how long replication takes on a per-sync and per-table basis. [GSM]</li>
  <li>Add more bucardo_ctl actions: install, reload, validate, restart, update [GSM]</li>
  <li>Allow adding of all tables in a database at once via bucardo_ctl [GSM]</li>
  <li>Add in bucardo_compress_delta function, to remove duplicate rows from the bucardo_delta table. [GSM]</li>
  <li>Allow the injection of custom messages into the Bucardo logs, and make an interface for same in bucardo_ctl. [GSM]</li>
  <li>Add the “warning_file” config parameter to log all ‘Warning’ messages. [GSM]</li>
  <li>Add validate_all_syncs() function, and allow an argument to both that and validate_sync() to force recreation of supporting objects. [GSM]</li>
</ul>

<h2 id="enhancements">Enhancements:</h2>

<ul>
  <li>Remove ‘Moose’ dependency. [GSM]</li>
  <li>Remove disable_triggers and disable_rules from the sync table. We simply choose pg_class or replica based on the version of the database in question. [GSM]</li>
  <li>Rewrite the pushdelta sync method to be more efficient and safer. [GSM]</li>
  <li>Change from Mail::Sendmail to Net::SMTP [Ben Allen]</li>
  <li>Allow wildcards in the ‘bucardo_ctl kick’ [Josh Tolley]</li>
  <li>Improve the FreeBSD scripts/bucardo_ctl.rc file [Ben Allen]</li>
  <li>Add “sendmail” option to the customcode input. [Ben Allen]</li>
  <li>Add ‘bucardo_ctl upgrade’ to make intra-version upgrades easy and automatic. [Selena Deckelmann and GSM]</li>
  <li>Add more tests and improve existing ones. [Josh Tolley]</li>
  <li>Force READ WRITE mode so Bucardo works on read only databases. [GSM]</li>
  <li>Make the audit_pid table more useful. Use sequences instead of PIDs to find children. Allow for the audit_pid table to be toggled off. [GSM]</li>
  <li>Remove the debugstderr and debugstdout options, as they never worked correctly anyway. [GSM]</li>
  <li>When truncating during fullcopy, fallback to delete if it fails. [GSM]</li>
  <li>On startup, all syncs that may have trigger-based notifies are initially kicked. [GSM]</li>
  <li>MCP listens for pings during table validations. [GSM]</li>
  <li>Have master_q use a trigger, not multiple rules. Remove the need for a separate create_child_q() function. [GSM]</li>
  <li>Default for log_showtime is now ‘scalar localtime’ rather than epoch seconds. [GSM]</li>
  <li>No longer require a reason for the “stop” action. [GSM]</li>
  <li>Add INSTALL_BUCARDODIR for quick and dirty ‘make install’ [GSM]</li>
</ul>

<h2 id="bug-fixes">Bug fixes:</h2>

<ul>
  <li>Fix failure to disable/enable triggers when using pg_class and table and schema are words changed by quote_ident. [Ben Allen]</li>
  <li>Tolerate incompatibility in DEFAULT of negative numbers between Postgres 8.2 and 8.3. [Jon Jensen]</li>
  <li>Do better checking of bucardo_ctl executable when MCP is restarting. [Ben Allen]</li>
  <li>Change timestamp to timestamptz where needed inside Bucardo.pm [Yan Farmawan]</li>
  <li>Put schema in db_getconn calls [Alex Bahlai]</li>
  <li>Record the proper PID for the MCP in the pid file [Goran Gugic]</li>
  <li>Set the tcp_* defaults in bucardo_config to zero (system default). [GSM]</li>
  <li>Allow for dead columns when checking attnums. [GSM]</li>
  <li>Do not attempt respawn of MCP if mcp_dbproblem_sleep is 0. [GSM]</li>
</ul>

<h1 id="version-310-released-april-6-2008">Version 3.1.0, released April 6, 2008</h1>

<ul>
  <li>Fix race condition in bucardo_delta/bucardo_track updates for pushdelta syncs. [GSM]</li>
  <li>Auto-detect primary keys (or unique indexes) for added tables. [GSM]</li>
  <li>Add update_bucardo_schema.pl to facilitate version changes. [GSM]</li>
  <li>Use correct quoted/non-quoted versions of primary keys to allow primary keys with spaces, etc. [GSM]</li>
  <li>Add new options to log_showtime to show non-epoch time strings [GSM]</li>
  <li>Make bucardo_ctl use the global version number, not its own. [GSM]</li>
  <li>Support bytea in primary key and regular columns. [GSM]</li>
</ul>

<h1 id="version-309-released-march-26-2008">Version 3.0.9, released March 26, 2008</h1>

<ul>
  <li>Fix problem causing killed controller to not re-do interrupted syncs on restart. [GSM]</li>
</ul>

<h1 id="version-308-released-february-5-2008">Version 3.0.8, released February 5, 2008</h1>

<ul>
  <li>Fix error in ‘latest’ conflict code. [Adam Wendt].</li>
  <li>Filter out inactive target dbs from bucardo-report script. [Spencer Christensen <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#115;&#099;&#104;&#114;&#105;&#115;&#116;&#101;&#110;&#115;&#101;&#110;&#064;&#098;&#097;&#099;&#107;&#099;&#111;&#117;&#110;&#116;&#114;&#121;&#046;&#099;&#111;&#109;">&#115;&#099;&#104;&#114;&#105;&#115;&#116;&#101;&#110;&#115;&#101;&#110;&#064;&#098;&#097;&#099;&#107;&#099;&#111;&#117;&#110;&#116;&#114;&#121;&#046;&#099;&#111;&#109;</a>]</li>
  <li>Fix race condition in bucardo_delta/bucardo_track updates for pushdelta syncs. [GSM]</li>
  <li>Fix a sorting problem in the bucardo-report script. [Jon Jensen <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#106;&#111;&#110;&#064;&#101;&#110;&#100;&#112;&#111;&#105;&#110;&#116;&#046;&#099;&#111;&#109;">&#106;&#111;&#110;&#064;&#101;&#110;&#100;&#112;&#111;&#105;&#110;&#116;&#046;&#099;&#111;&#109;</a>]</li>
  <li>Fix problem with after_sync code not firing at correct time for staylive kids. [GSM]</li>
</ul>

<h1 id="version-307-released-october-11-2007">Version 3.0.7, released October 11, 2007</h1>

<ul>
  <li>Allow bucardo_ctl options to be specified in a .bucardorc file. [GSM]</li>
  <li>Add new index to bucardo_delta for faster purging. [GSM]</li>
  <li>Add a BSD-style rc file in the scripts directory. [Ben Allen <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#098;&#115;&#097;&#064;&#108;&#097;&#110;&#108;&#046;&#103;&#111;&#118;">&#098;&#115;&#097;&#064;&#108;&#097;&#110;&#108;&#046;&#103;&#111;&#118;</a>]</li>
  <li>Activate the “latest” standard_conflict method. [GSM]</li>
  <li>Fix error for tables with primary key and no other columns in pushdelta/swap syncs, per report from Ben Allen. [GSM]</li>
  <li>Change pid and ppid columns in table “q” from smallint to integer. [Ben Allen <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#098;&#115;&#097;&#064;&#108;&#097;&#110;&#108;&#046;&#103;&#111;&#118;">&#098;&#115;&#097;&#064;&#108;&#097;&#110;&#108;&#046;&#103;&#111;&#118;</a>]</li>
  <li>Ensure sourcedbh used by customcode has inactivedestroy set. [GSM]</li>
  <li>Find system grep rather than hard-coding the path [Jeff Boes <a href="&#109;&#097;&#105;&#108;&#116;&#111;:&#106;&#101;&#102;&#102;&#064;&#101;&#110;&#100;&#112;&#111;&#105;&#110;&#116;&#046;&#099;&#111;&#109;">&#106;&#101;&#102;&#102;&#064;&#101;&#110;&#100;&#112;&#111;&#105;&#110;&#116;&#046;&#099;&#111;&#109;</a>]</li>
  <li>Fix for tests: make third database have a default password. [GSM]</li>
  <li>Add ping method to CTL and KID processes. [GSM]</li>
</ul>

<h1 id="version-306-first-public-release-on-september-1-2007">Version 3.0.6, first public release, on September 1, 2007</h1>

<p><a href="/Category:Bucardo" title="wikilink">Category:Bucardo</a></p>

</div>
			<div id='catlinks' class='catlinks catlinks-allhidden'></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div class="portlet" id="p-logo">
	<h2><a href="/"Array>bucardo.org</a></h2>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
</div>
</body></html>

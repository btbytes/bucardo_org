<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="" xml:lang="en" lang="en" dir="ltr">
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <title>{PageTitle}Bucardo</title>
		<style type="text/css" media="screen, projection">/*<![CDATA[*/
			@import "/css/common/shared.css";
			@import "/css/BucardoGreen/main-glossy.css";
		/*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="?303" />
		<!--[if lt IE 7]><meta http-equiv="imagetoolbar" content="no" /><![endif]-->
	</head>
<body class="mediawiki  ltr ">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
		<div id="bodyContent">
			<div id="contentSub"></div>
			<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr">
<h2 id="pgsi">pgsi</h2>

<p><strong>pgsi</strong> is the Postgres System Impact report, a script that analyzes Postgres log files and reports on which queries have the highest overall impact on the server. The impact is computed by looking at not only how long each query takes to complete, but how many times it is run, and the time period between subsequent runs. The report show the queries with the highest system impact, grouped by the type of query (SELECT, UPDATE, etc.)</p>

<h3 id="download">Download</h3>

<p>The latest version of pgsi, 1.7.1, can be downloaded at:</p>

<ul>
  <li><a href="http://bucardo.org/downloads/pgsi-1.7.1.tar.gz">pgsi-1.7.1.tar.gz</a></li>
</ul>

<h3 id="basic-usage">Basic Usage</h3>

<p>To use pgsi, you must run it against a <a href="/Postgres" title="wikilink">Postgres</a> logfile that has full logging enabled. Then run:</p>

<p><code class="highlighter-rouge"> perl pgsi.pl --file=logfile &gt; pgsi.html</code></p>

<h3 id="postgres-logging-options">Postgres Logging Options</h3>

<p>Make sure the following options are set in your postgresql.conf, or otherwise enabled for the traffic you want pgsi to analyze:</p>

<p><code class="highlighter-rouge"> log_duration = on</code>
<code class="highlighter-rouge"> log_statement = 'all'</code></p>

<p>If you’re using the stderr log log destination (the default) you’ll also need something like the following line prefix at minimum:</p>

<p><code class="highlighter-rouge"> log_line_prefix = '%t %p '</code></p>

<p>However pgsi will support additional information following that on the line. For example remote host (<em>%h</em>), user name (<em>%u</em>), and database name (<em>%d</em>) are often useful for filtering the log before analysis, and can be helpful if you need to manually read or track activity through the log itself.</p>

<h3 id="command-line-options">Command Line Options</h3>

<ul>
  <li>–version
    <ul>
      <li>Returns the version number</li>
    </ul>
  </li>
  <li>–verbose
    <ul>
      <li>Increases the level of verbosity</li>
    </ul>
  </li>
  <li>–help
    <ul>
      <li>Gives some basic help</li>
    </ul>
  </li>
  <li>–file=x
    <ul>
      <li>The log file to parse. If not given, will read stdin. This can be used more than once to read in multiple files at one time.</li>
    </ul>
  </li>
  <li>–format=X
    <ul>
      <li>Indicates the format of the output file. Current options are <strong>html</strong> and <strong>mediawiki</strong></li>
    </ul>
  </li>
  <li>–mode=X
    <ul>
      <li>Indicates the log file mode. Current options are <strong>pid</strong>, <strong>csv</strong>, <strong>bare</strong>, and <strong>syslog</strong></li>
    </ul>
  </li>
  <li>–color
    <ul>
      <li>Adds syntax highlighting to the queries in html format. On by default, can be turned off with –no-color</li>
    </ul>
  </li>
</ul>

<h3 id="bugs-and-feature-requests">Bugs and Feature Requests</h3>

<p>Bugs should be reported through <a href="http://bucardo.org/bugzilla">the bugzilla bug tracking site</a>. Feature requests are welcome there as well, or send us an email.</p>

<h3 id="development">Development</h3>

<p>Everyone is encouraged to look over and make improvements to the code. The latest development version can be obtained by running:</p>

<p><code class="highlighter-rouge"> git clone </code><a href="git://bucardo.org/pgsi.git"><code class="highlighter-rouge">git://bucardo.org/pgsi.git</code></a></p>

<p>There is also a <a href="http://github.com/bucardo">GitHub mirror</a> for easy patch contribution by the general public.</p>

<p><a href="/Category:pgsi" title="wikilink">Category:pgsi</a></p>

</div>
			<div id='catlinks' class='catlinks catlinks-allhidden'></div>			<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div class="portlet" id="p-logo">
	<h2><a href="/"Array>bucardo.org</a></h2>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
</div>
</body></html>
